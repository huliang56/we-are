<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<table>
		<form id="testForm" method="post" enctype="multipart/form-data" action="http://pan.tes-sys.com/skydisk-ms/api/fileUpload.html">
		<tbody><tr>
			<td>d</td>
			<td><input type="text" name="d" value="0B1142E1878B2119EB28B8997D829828"></td>
		</tr>
		<tr>
			<td>upload_file</td>
			<td>
				<input type="file" name="upload_file">
			</td>
		</tr>
		<tr>
			<td>dir_id</td>
			<td><input type="text" name="dir_id" value="9844ADF67C0B21414A0EDEBD6AC47B94"></td>
		</tr>
		<tr>
			<td>pub_flag</td>
			<td><input type="text" name="pub_flag" value="2"></td>
		</tr>
		<tr>
			<td>user_id</td>
			<td><input type="text" name="user_id" value="9AE969E5687D99F7664C140AA4C73B48"></td>
		</tr>
		<tr>
			<td>response_url</td>
			<td><input type="text" name="response_url" value="http://localhost:3000/getUploadFile"></td>
		</tr>
	</tbody>
	<button type="submit" id="uploadbtn">提交</button>
	</form>
	</table>
</body>
<script type="text/javascript" src="../lib/js/jquery-3.1.0.min.js"></script>
<script type="text/javascript" src="../lib/js/jQuery.md5.js"></script>
<script type="text/javascript">
	var key = 'A91E2F';
	var currentDate = getDate();
	var md5Key = $.md5("" + key + currentDate).toUpperCase();
	$("[name=d]").attr('value', md5Key);
	$("[name=upload_file]").change(function(event) {
		window.parent.uploading();
		$("#uploadbtn")[0].click();
	});
	if (getQueryString('flag')) {
		console.log(<%=result%>);
		// var flag = getQueryString('flag');
		// var info = getQueryString('info');
		// var fileid = getQueryString('fileid');
		// var filename = getQueryString('filename');
		// var filesize = getQueryString('filesize');
		// var fileextname = getQueryString('fileextname');
		// var fileurl = getQueryString('fileurl');
		// window.parent.getUploadFileInfo(flag,info,fileid,filename,filesize,fileextname,fileurl);
	}
	function getQueryString(name) {
		var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
		var r = window.location.search.substr(1).match(reg);
		if (r != null) return unescape(r[2]);
		return null;
	}

	function getDate() {
		var mydate = new Date();
		var year = "" + mydate.getFullYear();
		var month = mydate.getMonth() + 1;
		var day = mydate.getDate();
		var str = year + "-" + (month < 10 ? "0" + month : month) + "-" + (day < 10 ? "0" + day : day);
		return str;
	}
</script>
</html>
